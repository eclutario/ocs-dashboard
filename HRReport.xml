<?xml version="1.0" encoding="UTF-8"?>
<Module>
    <ModulePrefs title="HR Report"
                 description="HR Report"
                 author="Victor Alarcon" author_email="vic@irri.org"
                 author_link="www.irri.org"
                 title_url="www.irri.org"
                 scrolling="true">
        <Require feature="dynamic-height"/>
     <Require feature="settitle" />
	 <Require feature="setprefs" />
	</ModulePrefs>
	<UserPref name="title" display_name="Title" required="false" />
	<UserPref name="_table_query_url" display_name="Data source url" required="true" />
	<Content type="html"><![CDATA[
        <script type="text/javascript" src="https://www.google.com/jsapi"></script>
		<script>
			$(document).ready(function() {
				$('#AgrReport').css('font-size', '.8em');
				$( "#tabs" ).tabs({
					collapsible: true,
					activate: 	function (event, ui) {
									if(ui.newTab.index()==1) {
										$("#filters").hide(1000);
										$("#dashboardAEC").hide(1000);
									}
									else {
										$("#filters").show(1000);		
										$("#dashboardAEC").show(1000);									
									}
								}
					});
			
			});
		</script>		
        <script type="text/javascript">
			var prefs = new _IG_Prefs();
			// The gviz helper for gadget specific functionality.
			var gadgetHelper = null;
			var motionChart;
			var dataSourceUrl = 'https://spreadsheets.google.com/tq?key=1Ha5wjKJxEfTxasTkDsrZ1EhmIMAD07wWMDdO7e86CYQ&gid=1936256765';
	_IG_RegisterOnloadHandler(loadVisualizationAPI);

			function loadVisualizationAPI() {
			  google.load('visualization', '1.1', { packages: ['controls', 'corechart','table','motionchart','map'] });
			  google.setOnLoadCallback(querySpreadsheet);
			};

	function querySpreadsheet()
	{
 		
		var motionQuery;
		motionQuery && motionQuery.abort();		
		motionQuery = new google.visualization.Query(dataSourceUrl + "&tq=Select A,G where A <> ''");
																		//	 
		var motionChart = new google.visualization.Map(document.getElementById('MapNationality'));
		var mapQueryWrapper =  new DashboardWrapper(motionQuery, motionChart, {showTip: true}, null);
		mapQueryWrapper.sendAndDraw();
 				google.visualization.drawChart({
				"containerId": "chart2",
				"dataSourceUrl": 'https://docs.google.com/a/irri.org/spreadsheet/tq?range=A1:C7&key=1Ha5wjKJxEfTxasTkDsrZ1EhmIMAD07wWMDdO7e86CYQ&gid=1252886937&headers=-1',
				"chartType": "BarChart",
				"options": {
				  "title":"IRRI Gender Demographics",
				  "vAxis": {"title": "Age Group"},
				  "hAxis": {"title": "Staff By Gender"},
				  "isStacked": true,
					width: 1200,
					height: 600,   
				}
				
			  });			  
	}    
        </script>
<body>
<br />
	<div id="AgrReport" style='font-size: 0.85em;'> 
		<div id="dashboard">
					<table width='100%'>
						<tr>
							<td style='width: 10%; font-size: smaller;' valign="top">
								<div id="filters" style='font-size: 0.85em;'>
									<div  id="nationalityFilter" ></div>
									<div id="divisionFilter" ></div>
									<div id="ouFilter" ></div>
								</div>
							</td>
							<td style='width: 90%; font-size: smaller;' valign="top">
								<div id="tabs">
									<ul>
										<li><a href="#tabs-1">Map</a></li>
										<li><a href="#tabs-2">Gender Chart</a></li>

									</ul>
									<div id="tabs-1">

										<div id="MapNationality" ></div>								
									</div>
									<div id="tabs-2">
										<div id="chart2"></div>
									</div>								
							</td>
						</tr>

					</table>
				</div>
				<p>&nbsp;</p>


		
		</div>
		<div id="dialog" style='font-size: 0.85em;'>
			
		</div>	
	</div>
</body>
  ]]>
    </Content>
</Module>
